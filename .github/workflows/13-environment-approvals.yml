# CONCEPT 13: Environment Approvals (Manual Review)
# Learn how to require approval before deploying

name: 13 - Environment Approvals Demo

on:
  push:
    branches:
      - main
  workflow_dispatch:

jobs:
  # JOB 1: Build (no approval needed)
  build:
    runs-on: ubuntu-latest
    steps:
      - name: Build application
        run: |
          echo "Building application..."
          echo "Build complete!"
  
  # JOB 2: Deploy to staging (approval if environment configured)
  deploy-staging:
    runs-on: ubuntu-latest
    needs: build
    # ENVIRONMENT: Links job to an environment
    # Configure approval in: Repo Settings > Environments
    environment:
      name: staging
      url: https://staging.example.com
    steps:
      - name: Deploy to staging
        run: |
          echo "Deploying to STAGING..."
          echo "Staging deployment complete!"
  
  # JOB 3: Deploy to production (requires approval)
  deploy-production:
    runs-on: ubuntu-latest
    needs: deploy-staging
    # PRODUCTION: Should have approval requirement
    environment:
      name: production
      url: https://production.example.com
    steps:
      - name: Deploy to production
        run: |
          echo "Deploying to PRODUCTION..."
          echo "Production deployment complete!"
          echo ""
          echo "=== ENVIRONMENT APPROVALS ==="
          echo "To enable approvals:"
          echo "1. Go to repo Settings > Environments"
          echo "2. Create 'production' environment"
          echo "3. Check 'Required reviewers'"
          echo "4. Add yourself as reviewer"
          echo "5. Run workflow - it will WAIT for approval!"
